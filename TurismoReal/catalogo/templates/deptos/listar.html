{% extends 'dashboard.html' %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turimos Real</title>
    <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:ital,wght@0,700;1,400;1,700&family=Open+Sans:ital,wght@0,400;0,700;1,600&display=swap" rel="stylesheet">
    {% load static %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <link href="{%static 'css/prueba.css' %}" rel="stylesheet" />
    
</head>

{% block content %}
{% load humanize %}
<br>
<br>
<br>
<div class="card">
    <div class="card-body">
        <h1>Lista de Departamentos</h1>
        <div class="card card-header-actions mx-auto">
            <div class="card-header">
                <div>

                    <a class="btn btn-warning btn-sm" href="{% url 'listar_inventario' %}" role="button">Inventario</a>
                    <a class="btn btn-success btn-sm" href="{% url 'agregar_depto' %}" role="button">Añadir Departamento</a>

                </div>
            </div>
        </div>
        <table class="table table-striped table-hover table.responsive-sm">
            <tr>
                <th>ID</th>
                <th>NOMBRE</th>
                <th>HABITACIONES</th>
                <th>PRECIO</th>
                <th>DISPONIBLE</th>
                <th>COMUNA</th>
                <th>REGION</th>
                <th>OPCIONES</th>
            </tr>
            {% for p in departamentos %}
                <tr>
                    <!-- ID -->
                    <td>{{ p.id_depto }}</td>

                    <!-- NOMRBE -->
                    <td>{{ p.nombre | title }}</td>

                    <!-- HABITACIONES -->
                    <td>{{ p.habitaciones }}</td>

                    <!-- PRECIO -->
                    <td>$ {{ p.precio | intcomma }}</td>

                    <!-- DISPONIBLE -->
                    <td>
                        {% if p.disponible %}
                        SI
                        {% else %}
                        NO
                        {% endif %}
                    </td>
                    
                    <!-- COMUNA -->

                    <td>{{ p.comuna_id }}</td>
                  
                    <!-- REGION -->
                     <td>{{ p.region_id }}</td>

                    <!-- OPCIONES -->
                    <td>
                        <a href="{% url 'modificar_depto' p.id_depto %}" class="btn btn-info btn-sm">Modificar</a>
                        <a href="#" onclick="eliminarDepto({{ p.id_depto }})" class="btn btn-danger btn-sm">Eliminar</a>
                    </td>
                </tr>
            {% endfor %}
        </table>
        <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        {% if messages %}
                {% for m in messages %}
                <script>
                    Swal.fire({
                        "title":"Felicitaciones",
                        "text":"{{m}}",
                        "icon": "success"
                    })
                </script>
                {% endfor %}
        {% endif %}
    </div>
</div>

{% block js %}

<script>
    function eliminarDepto(id_depto){
        Swal.fire({
            "title":"¿Estás seguro que deseas eliminar?",
            "text": "Esta acción no se puede deshacer",
            "icon":"question",
            "showCancelButton": true,
            "cancelButtonText": "No, Cancelar",
            "confirmButtonText":"Si, Eliminar",
            "reverseButtons":true,
            "confirmButtonColor":"#dc3545"

        })
        .then(function(result){
            if(result.isConfirmed){
                window.location.href = "/eliminar-depto/"+ id_depto+"/"
            }
        })
    } 
</script>

{% endblock %}

{% endblock %}