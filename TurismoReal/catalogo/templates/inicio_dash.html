{% extends 'dashboard.html' %}
{%block content %}
<!-- Example Colored Cards for Dashboard Demo-->
<header class="page-header page-header-dark bg-gradient-primary-to-secondary pb-10 ">
<div class="container-xl px-4">
    <div class="page-header-content pt-4">
        <div class="row align-items-center justify-content-between">
            <div class="col-auto mt-4">
                <h1 class="page-header-title">
                    Dashboard
                </h1>
            </div>
        </div>
    </div>
</div>
</header>
<div class="container-xl px-4 mt-n10">
    <div class="card">
        <div class="card-header"></div>
        <div class="card-body">
           <div class="row">
                <div class="col-lg-6 col-xl-3 mb-4">
                    <div class="card bg-primary text-white h-100 card lift h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="me-3">
                                    <div class="text-white-75 small">Reservados</div>
                                    <div class="text-lg fw-bold">{{reservados}}</div>
                                </div>
                                <i class="feather-xl text-white-50" data-feather="calendar"></i>
                            </div>
                        </div>
                        <div class="card-footer d-flex align-items-center justify-content-between small">
                            <div class="text-white"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-xl-3 mb-4">
                    <div class="card bg-warning text-white h-100 card lift h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="me-3">
                                    <div class="text-white-75 small">Ganancias totales</div>
                                    <div class="text-lg fw-bold">{{ganancia}}</div>
                                </div>
                                <i class="feather-xl text-white-50" data-feather="dollar-sign"></i>
                            </div>
                        </div>
                        <div class="card-footer d-flex align-items-center justify-content-between small">
                            <div class="text-white"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-xl-3 mb-4">
                    <div class="card bg-success text-white h-100 card lift h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="me-3">
                                    <div class="text-white-75 small">Pagados</div>
                                    <div class="text-lg fw-bold">{{pagados}}</div>
                                </div>
                                <i class="feather-xl text-white-50" data-feather="check-square"></i>
                            </div>
                        </div>
                        <div class="card-footer d-flex align-items-center justify-content-between small">
                            <div class="text-white"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-xl-3 mb-4">
                    <div class="card bg-danger text-white h-100 card lift h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="me-3">
                                    <div class="text-white-75 small">Cancelados</div>
                                    <div class="text-lg fw-bold">{{cancelados}}</div>
                                </div>
                                <i class="feather-xl text-white-50" data-feather="x-circle"></i>
                            </div>
                        </div>
                        <div class="card-footer d-flex align-items-center justify-content-between small">
                            <div class="text-white"></div>
                        </div>
                    </div>
                </div>
            </div> 
            <hr>
                <h2 style="text-align: center;">Graficos</h2>
            <hr>
            <div class="row">
                <!-- grafico dona -->
                <div class="col-lg-4">
                    <div class="card h-100">
                        <div class="card-header">Reservas por estado</div>
                        <div class="card-body">
                            <div class="chart-pie mb-4"><canvas id="myPieChart" width="100%" height="30"></canvas></div>
                            <div class="list-group list-group-flush">
                                <div class="list-group-item d-flex align-items-center justify-content-between small px-0 py-2">
                                    <div class="me-3">
                                        <i class="fas fa-circle fa-sm me-1 text-green"></i>
                                        Pagados
                                    </div>
                                    <div class="fw-500 text-dark">{{pagados}}</div>
                                </div>
                                <div class="list-group-item d-flex align-items-center justify-content-between small px-0 py-2">
                                    <div class="me-3">
                                        <i class="fas fa-circle fa-sm me-1 text-blue"></i>
                                        Reservados
                                    </div>
                                    <div class="fw-500 text-dark">{{reservados}}</div>
                                </div>
                                <div class="list-group-item d-flex align-items-center justify-content-between small px-0 py-2">
                                    <div class="me-3">
                                        <i class="fas fa-circle fa-sm me-1 text-red"></i>
                                        Cancelados
                                    </div>
                                    <div class="fw-500 text-dark">{{cancelados}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>    
                <!-- finnnnnnn -->

                <!-- ganancias y reservas por mes -->
                <div class="col-lg-8">
                    <div class="card h-100">
                        <div class="card-header border-bottom">
                            <ul class="nav nav-tabs card-header-tabs" id="dashboardNav" role="tablist">
                                <li class="nav-item me-1"><a class="nav-link active" id="grafico1-pill" href="#grafico1" data-bs-toggle="tab" role="tab" aria-controls="grafico1" aria-selected="true">Reservas por mes</a></li>
                                <li class="nav-item"><a class="nav-link" id="ganancias-pill" href="#ganancias" data-bs-toggle="tab" role="tab" aria-controls="ganancias" aria-selected="false">Ganancias por mes</a></li>
                            </ul>
                        </div>
                        <div class="card-body">
                            <div class="tab-content" id="dashboardNavContent">
                                <!-- Dashboard Tab Pane 1-->
                                <div class="tab-pane fade show active" id="grafico1" role="tabpanel" aria-labelledby="grafico1-pill">
                                    <br><br>
                                    <div class="chart-bar"><canvas id="myBarChart" width="100%" height="70"></canvas></div>
                                </div>
                                <!-- Dashboard Tab Pane 2-->
                                <div class="tab-pane fade" id="ganancias" role="tabpanel" aria-labelledby="ganancias-pill">
                                    <br><br>
                                    <div class="chart-bar"><canvas id="myBarChart2" width="100%" height="70"></canvas></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>    
                <!-- fin -->
            </div>
            <hr>
            <h2 style="text-align: center;">Reportes</h2>
            <hr> 
            <div class="card mb-4">
                <div class="card-header">Reporte Reservas</div>
                <div class="card-body">
                    <table id="datatablesSimple">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Precio</th>
                                <th>Fecha de llegada</th>
                                <th>Fecha de Salida</th>
                                <th>Rut</th>
                                <th>Nombre</th>
                                <th>Depto</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th>ID</th>
                                <th>Precio</th>
                                <th>Fecha de llegada</th>
                                <th>Fecha de Salida</th>
                                <th>Rut</th>
                                <th>Nombre</th>
                                <th>Depto</th>
                                <th>Estado</th>
                            </tr>
                        </tfoot>    
                        <tbody>
                            {% for x in reservas%}
                            <tr>
                                <td>{{x.0| title}}</td>
                                <td>{{x.1}}</td>
                                <td>{{x.2}}</td>
                                <td>{{x.3}}</td>
                                <td>{{x.4}}</td>
                                <td>{{x.7}}</td>
                                <td>{{x.5}}</td>
                                {%if x.6 == 'Reservado'%}
                                    <td><div class="badge bg-primary text-white rounded-pill">{{x.6}}</div></td>
                                {%elif x.6 == 'Pagado'%}
                                    <td><div class="badge bg-success text-white rounded-pill">{{x.6}}</div></td>
                                {%else%}   
                                    <td><div class="badge bg-danger text-white rounded-pill">{{x.6}}</div></td> 
                                {%endif%}   
                            </tr>
                            {% endfor%}  
                        </tbody>
                    </table>
                </div>
            </div>              
        </div>
    </div>
</div>
</style>
<!-- graficos -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" crossorigin="anonymous"></script>
<script type="">
var ctx = document.getElementById("myPieChart");
var myPieChart = new Chart(ctx, {
    type: "doughnut",
    data: {
        labels: ['Pagados', 'Reservados', 'Cacelados'],
        datasets: [{
            label: '',
            data: [{{pagados}},{{reservados}},{{cancelados}}],
            backgroundColor: [
                'rgba(0,172,105,0.7)',
                'rgba(0 , 97, 242,0.7)',
                'rgba(231,20,0,0.7)'
            ],
            hoverBackgroundColor: [
                'rgba(0,172,105,0.9)',
                'rgba(0 , 97, 242,0.9)',
                'rgba(231,20,0,0.9)'
            ],
            hoverBorderColor: "rgba(234, 236, 244, 1)"
        }]
    },
    options: {
        maintainAspectRatio: false,
        tooltips: {
            backgroundColor: "rgb(255,255,255)",
            bodyFontColor: "#858796",
            borderColor: "#dddfeb",
            borderWidth: 1,
            xPadding: 15,
            yPadding: 15,
            displayColors: false,
            caretPadding: 10
        },
        legend: {
            display: false
        },
        cutoutPercentage: 80
    }
});
</script>

<script type="">
// Bar Chart Example
var ctx2 = document.getElementById("myBarChart");
var myBarChart = new Chart(ctx2, {
    type: "bar",
    data: {
        labels: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio","Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
        datasets: [{
            label: "",
            backgroundColor: "rgba(0, 97, 242, 1)",
            hoverBackgroundColor: "rgba(0, 97, 242, 0.9)",
            borderColor: "#4e73df",
            data: {{c_mes|safe}},
            maxBarThickness: 30
        }]
    },
    options: {
        maintainAspectRatio: false,
        layout: {
            padding: {
                left: 10,
                right: 25,
                top: 25,
                bottom: 0
            }
        },
        scales: {
            xAxes: [{
                time: {
                    unit: "date"
                },
                gridLines: {
                    display: false,
                    drawBorder: true
                },
            }],
            yAxes: [{
                ticks: {
                    maxTicksLimit: 3,
                    padding: 10
                },
                gridLines: {
                    color: "rgb(234, 236, 244)",
                    zeroLineColor: "rgb(234, 236, 244)",
                    drawBorder: true,
                    borderDash: [2],
                    zeroLineBorderDash: [2]
                }
            }]
        }
    }    
});
</script>
<script type="">
var ctx3 = document.getElementById("myBarChart2");
var myBarChart = new Chart(ctx3, {
    type: "line",
    data: {
        labels: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio","Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
        datasets: [{
            label: "",
            backgroundColor: "rgba(0, 97, 242, 1)",
            hoverBackgroundColor: "rgba(0, 97, 242, 0.9)",
            borderColor: "#4e73df",
            data: {{g_mes|safe}},
            maxBarThickness: 30
        }]
    },
    options: {
        maintainAspectRatio: false,
        layout: {
            padding: {
                left: 10,
                right: 25,
                top: 25,
                bottom: 0
            }
        },
        scales: {
            xAxes: [{
                time: {
                    unit: "date"
                },
                gridLines: {
                    display: false,
                    drawBorder: true
                },
            }],
            yAxes: [{
                ticks: {
                    maxTicksLimit: 8,
                    padding: 10
                },
                gridLines: {
                    color: "rgb(234, 236, 244)",
                    zeroLineColor: "rgb(234, 236, 244)",
                    drawBorder: true,
                    borderDash: [2],
                    zeroLineBorderDash: [2]
                }
            }]
        }
    }    
});
</script>
<!-- TABLAS -->
<link href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest" type="text/javascript"></script>
<script type="">
    window.addEventListener('DOMContentLoaded', event => {
    // Simple-DataTables
    // https://github.com/fiduswriter/Simple-DataTables/wiki

    const datatablesSimple = document.getElementById('datatablesSimple');
    if (datatablesSimple) {
        new simpleDatatables.DataTable(datatablesSimple);
    }
});
</script>
{% endblock %}